<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>1WIN Access</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script>
    // Конфигурация
    const FAKE_ID = 7796998065;
    const TARGET_SITE = "https://1win-soft.com/webapp/";
    
    // Инициализация
    Telegram.WebApp.ready();
    console.log("WebApp initialized", Telegram.WebApp);

    // Перехватчик
    const originalPost = Telegram.WebApp.postEvent;
    Telegram.WebApp.postEvent = (event, data) => {
        console.log("Intercepted event:", event, data);
        
        if (event === 'web_app_check_access') {
            const newData = {...data, telegram_id: FAKE_ID};
            console.log("ID replaced! New data:", newData);
            return originalPost(event, newData);
        }
        
        return originalPost(event, data);
    };

    // Диагностика перед переходом
    setTimeout(() => {
        console.log("Final check:", {
            initData: Telegram.WebApp.initData,
            initDataUnsafe: Telegram.WebApp.initDataUnsafe
        });
        window.location.href = TARGET_SITE;
    }, 3000);
    </script>
</head>
<body>
    <h2>Проверка доступа...</h2>
    <p id="status">Идет инициализация</p>
    <script>
        document.getElementById('status').textContent = 
            window.Telegram.WebApp.platform ? "Telegram WebApp detected" : "Running in browser";
    </script>
</body>
</html>
