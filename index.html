<!DOCTYPE html>
<html>
<head>
    <!-- 1. Подключаем Telegram WebApp ПЕРВЫМ -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <script>
        const FAKE_ID = 7796998065; // Ваш ID
        const FAKE_HASH = "fake_hash_" + Math.random().toString(36).substring(2);

        // 2. Проверяем, что Telegram WebApp загрузился
        if (!window.Telegram?.WebApp) {
            console.error("Telegram WebApp не загружен!");
        } else {
            // 3. Подменяем данные (обратите внимание на корректные кавычки и скобки)
            const fakeUser = {
                id: FAKE_ID,
                first_name: "User",
                last_name: "Fake",
                username: "fake_user",
                language_code: "en"
            };

            window.Telegram.WebApp.initData = `user=${encodeURIComponent(JSON.stringify(fakeUser))}&auth_date=${Math.floor(Date.now()/1000)}&hash=${FAKE_HASH}`;
            window.Telegram.WebApp.initDataUnsafe = {
                user: fakeUser,
                query_id: "fake_query_id",
                auth_date: Math.floor(Date.now()/1000),
                hash: FAKE_HASH
            };

            // 4. Перехватываем fetch-запросы
            const originalFetch = window.fetch;
            window.fetch = async (url, options) => {
                if (url.includes('/api/check-access')) {
                    console.log("[Подмена] Возвращаем успешный ответ");
                    return Promise.resolve(new Response(JSON.stringify({
                        status: true,
                        message: "Доступ разрешён (подмена)"
                    })));
                }
                return originalFetch(url, options);
            };

            // 5. Перенаправляем через 1 секунду
            setTimeout(() => {
                window.location.href = "https://1win-soft.com/webapp/";
            }, 1000);
        }
    </script>
</head>
<body>
    <div>Подмена данных Telegram...</div>
</body>
</html>
